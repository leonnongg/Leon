<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<title>Verification</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@500;700&display=swap" rel="stylesheet">
<style>
:root{
  --lav:#b37cff; --red:#ff3b3b; --bg:#0f1022; --card:#17183a;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:'Fredoka',sans-serif;
  background: radial-gradient(1200px 600px at 10% 10%, #2a1b55, #090a1a);
  color:#fff; display:flex; align-items:center; justify-content:center; height:100vh;
  overflow:hidden;
}
.glow{filter: drop-shadow(0 0 12px rgba(179,124,255,.7));}
.float{animation: float 3s ease-in-out infinite;}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}

.card{
  width:380px; max-width:92vw; background:linear-gradient(180deg,#1b1c46,#121236);
  border-radius:18px; padding:18px; text-align:center;
  box-shadow:0 20px 60px rgba(0,0,0,.6), inset 0 0 0 1px rgba(255,255,255,.06);
  position:relative;
}
.ribbon{
  position:absolute; top:-10px; left:50%; transform:translateX(-50%);
  background:linear-gradient(90deg,var(--lav),var(--red));
  padding:6px 14px; border-radius:999px; font-size:12px;
  box-shadow:0 0 18px rgba(255,0,0,.4);
}

.hidden{display:none}
input,button{width:100%; padding:12px; border-radius:12px; border:none; margin:8px 0; font-size:15px}
input{background:#0e0f2b; color:#fff; outline:none; box-shadow: inset 0 0 0 1px rgba(255,255,255,.08)}
button{
  background:linear-gradient(135deg,var(--red),var(--lav)); color:#fff; font-weight:700;
  cursor:pointer; transition:transform .1s, filter .1s;
}
button:active{transform:scale(.98); filter:brightness(1.1)}

.logo{
  display:flex; gap:10px; align-items:center; justify-content:center; margin-bottom:6px;
}
.coin{
  width:26px; height:26px; border-radius:50%;
  background:radial-gradient(circle at 30% 30%, #7cff9e, #19a35b);
  box-shadow: inset 0 0 0 3px rgba(0,0,0,.2), 0 0 10px rgba(25,163,91,.7);
  position:relative;
}
.coin:after{
  content:"$"; position:absolute; inset:0; display:grid; place-items:center; font-weight:900;
  color:#e9ffe9; text-shadow:0 0 6px rgba(255,255,255,.7);
}

.progress{background:#2a2b66;border-radius:999px;overflow:hidden;margin:10px 0}
.bar{
  height:12px;width:0;
  background:linear-gradient(90deg,#7cff9e,#4cff4c);
  transition:width .35s; box-shadow:0 0 10px rgba(76,255,76,.8);
}

.offer{
  background:#0f1033; border-radius:12px; padding:10px; margin:8px 0;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.06);
  animation: pop .25s ease;
}
@keyframes pop{from{transform:scale(.95);opacity:.6}to{transform:scale(1);opacity:1}}

small{opacity:.7}
.confetti{position:fixed; inset:0; pointer-events:none}

</style>
</head>
<body>

<canvas class="confetti hidden" id="fx"></canvas>

<div class="card">
  <div class="ribbon glow">Premium Unlock</div>

  <div class="logo float">
    <div class="coin"></div><div class="coin"></div><div class="coin"></div>
  </div>

  <div id="step1">
    <h2 class="glow">Enter your Discord username</h2>
    <input id="user" placeholder="username#0000" />
    <button onclick="start()">Verify</button>
  </div>

  <div id="loading" class="hidden">
    <h3>Checkingâ€¦</h3>
    <p>Verifying account</p>
  </div>

  <div id="step2" class="hidden">
    <h3 id="title" class="glow">Verified âœ”</h3>
    <p id="subtitle">Complete 3 offers to unlock</p>
    <small>Offers are sponsored and required to unlock.</small>
    <div class="progress"><div id="bar" class="bar"></div></div>
    <div id="offers"></div>
  </div>
</div>

<audio id="click" src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA="></audio>
<audio id="ding"  src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQAAAAA="></audio>

<script>
const clickid = new URLSearchParams(location.search).get("clickid") || "none";
let poll=null;

function start(){
  if(!user.value) return alert("Enter your username");
  click.play();
  step1.classList.add("hidden");
  loading.classList.remove("hidden");
  setTimeout(()=>{
    loading.classList.add("hidden");
    step2.classList.remove("hidden");
    loadOffers();
    poll=setInterval(checkProgress,3000);
  },1200);
}

async function loadOffers(){
  const geo = await fetch("https://ipapi.co/json").then(r=>r.json()).catch(()=>({country_code:"US"}));
  const res = await fetch("https://lockedapp.store/api/v2",{headers:{
    "Authorization":"Bearer 40260|ycogeb6MnkelTiHaPB0qDNldwdJ02JhtVrSfAoDS7968e3d7"}});
  const data = await res.json();

  let offers=(data.offers||[]).filter(o=>o.payout_type==="cpi" && Array.isArray(o.countries) && o.countries.includes(geo.country_code));
  offers.sort((a,b)=>b.payout-a.payout); offers=offers.slice(0,5);

  offersBox.innerHTML="";
  offers.forEach(o=>{
    const join=o.tracking_url.includes("?")?"&":"?";
    const d=document.createElement("div");
    d.className="offer";
    d.innerHTML=`<b>${o.name}</b><br>$${o.payout}<br>
      <button onclick="click.play();location.href='${o.tracking_url}${join}subid=${clickid}'">Install</button>`;
    offersBox.appendChild(d);
  });
}

async function checkProgress(){
  const r=await fetch(`/api/postback?check=${encodeURIComponent(clickid)}&r=${Math.random()}`);
  if(!r.ok) return;
  const c=parseInt(await r.text())||0;
  bar.style.width=Math.min(c*33,100)+"%";
  if(c>=3){
    clearInterval(poll);
    offersBox.innerHTML="";
    title.textContent="All done! ðŸŽ‰";
    subtitle.textContent="You are qualified.";
    ding.play(); celebrate();
  }
}

// tiny confetti
function celebrate(){
  const cv=fx,ctx=cv.getContext("2d"); cv.width=innerWidth; cv.height=innerHeight; cv.classList.remove("hidden");
  let parts=Array.from({length:120},()=>({x:Math.random()*cv.width,y:-20,v:2+Math.random()*3,r:Math.random()*Math.PI,c:`hsl(${Math.random()*360},90%,60%)`}));
  (function anim(){
    ctx.clearRect(0,0,cv.width,cv.height);
    parts.forEach(p=>{p.y+=p.v; ctx.fillStyle=p.c; ctx.fillRect(p.x,p.y,6,6);});
    parts=parts.filter(p=>p.y<cv.height+20);
    if(parts.length) requestAnimationFrame(anim); else cv.classList.add("hidden");
  })();
}

const step1=document.getElementById("step1"),loading=document.getElementById("loading"),step2=document.getElementById("step2");
const offersBox=document.getElementById("offers"),bar=document.getElementById("bar");
const title=document.getElementById("title"),subtitle=document.getElementById("subtitle");
const user=document.getElementById("user"),click=document.getElementById("click"),ding=document.getElementById("ding"),fx=document.getElementById("fx");
</script>
</body>
</html>